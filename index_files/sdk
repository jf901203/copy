;(function(){var Context=function(){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var s=function(){return(s=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function t(i,a,s,c){return new(s=s||Promise)(function(t,e){function n(t){try{r(c.next(t))}catch(t){e(t)}}function o(t){try{r(c.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,o)}r((c=c.apply(i,a||[])).next())})}function c(n,o){var r,i,a,t,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,i=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=o.call(n,s)}catch(t){e=[6,t],i=0}finally{r=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function o(){return"http://nativeapp.toutiao.com"==document.referrer||f.test(d)}function r(){return v.test(d)}function i(){return g.test(d)}function u(){return/windows phone/i.test(d)?"Windows Phone":/android/i.test(d)?"android":/iPad|iPhone|iPod/.test(d)&&!window.MSStream?"ios":"pc"}var e=["joke_essay","Joke"],a=["live_stream"],p=["aweme"],l=["News","NewsSocial","Explore","NewsArticle","NewsInHouse","Video","VideoInHouse","VideoArticle","aweme","open_news"].concat(e,a,["Video","VideoInHouse","VideoArticle"],p,["open_news","TTAD","douyin_lite"]),d=navigator.userAgent,f=new RegExp("("+l.join("|")+")","i"),h=new RegExp("("+e.join("|")+")","i"),v=new RegExp("("+a.join("|")+")","i"),g=new RegExp("("+p.join("|")+")","i"),_=new RegExp("("+["VideoArticle"].join("|")+")","i"),y=(new RegExp("("+["NewsArticle"].join("|")+")","i"),new RegExp("("+["TTAD"].join("|")+")","i")),w=function(){return"android"===u()};function m(t,e){window.sessionStorage.setItem(t,e)}function b(t){return window.sessionStorage.getItem(t)}function I(t){if(t.sourceIndex)return t.sourceIndex-t.parentNode.sourceIndex-1;for(var e=0;t=t.previousElementSibling;)e++;return e}function S(){return{path:location.pathname,referrer:document.referrer,search:location.search,title:document.title||"",page_url:location.href,page_type:window._page_type?window._page_type:0,site_id:function(){var t=window.location.pathname;return(t.match(/\d+/g)||[])[0]||""}()||""}}var k=function(t){if(t)return{xpath:function(t){for(var e="";t.length;){var n=Array.prototype.pop.apply(t);if(n&&n.tagName&&"body"!=n.tagName.toLowerCase()&&"html"!=n.tagName.toLowerCase()){var o="function"==typeof n.getAttribute?n.getAttribute("id"):"";e+=n.tagName.toLowerCase()+I(n)+(o?"#"+o:"")+(0==t.length?"":">")}}return e}(function(t){var e=function(t){var e=[];for(;t;)(t=t.parentNode)&&e.push(t);return e}(t);return e.unshift(t),e}(t))}};function x(t){var e=[];t=t||{};var n=/^(?:string|boolean|number)/i;for(var o in t)t.hasOwnProperty(o)&&n.test(typeof t[o])&&e.push(o+"="+t[o]);return e.join("&")}function L(t,e){var n=RegExp("[?&]"+t+"=([^&]*)").exec(e);return n&&decodeURIComponent(n[1].replace(/\+/g," "))}function C(t){var e=location.search;return L(t,e)||(e=document.referrer),L(t,e)}var E=0,R=1,A=2,M=(P.prototype.setBridgeState=function(t,e){switch(t){case"adInfo":this.adInfoFlag=e;break;case"appInfo":this.appInfoFlag=e}},P.prototype.callPromise=function(i){return t(this,void 0,void 0,function(){var o,r;return c(this,function(t){switch(t.label){case 0:return[4,(o=this).bridgeLoaded];case 1:return r=t.sent(),this.setBridgeState(i,E),[2,this.retry(function(){return new Promise(function(e,t){var n=setTimeout(function(){o.adInfoFlag!=E&&o.appInfoFlag!=E||t("timeout")},400);r.call(i,{},function(t){o.setBridgeState(i,A),e(t),clearTimeout(n)})})},1)]}})})},P.prototype.retry=function(o,r){void 0===r&&(r=1);var i=this;return new Promise(function(n){o().then(function(t){n(t)},function(){return t(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:if(1!==r)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),e=n,[4,o()];case 2:return e.apply(void 0,[t.sent()]),[3,4];case 3:return t.sent(),n({}),[3,4];case 4:return[3,6];case 5:n(i.retry(o,r-1)),t.label=6;case 6:return[2]}})})})})},P.prototype.track_event=function(e){return t(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.bridgeLoaded];case 1:return t.sent().call("track_event",e),[2]}})})},P.prototype.setSession=function(){return t(this,void 0,void 0,function(){var e,n;return c(this,function(t){switch(t.label){case 0:return n=[{}],[4,this.adInfo];case 1:return n=n.concat([t.sent()]),[4,this.appInfo];case 2:return e=s.apply(void 0,n.concat([t.sent()])),m("bridge",JSON.stringify(e)),[2]}})})},P);function P(t){this.adInfoFlag=R,this.appInfoFlag=R,this.bridgeLoaded=function(t){var n=document.createElement("script");n.src=t;var e=new Promise(function(t,e){n.onload=t,n.onerror=e});return document.head.appendChild(n),e}(t).then(function(){return window.ToutiaoJSBridge}),this.adInfo=this.callPromise("adInfo"),this.appInfo=this.callPromise("appInfo"),this.setSession()}function N(){var e,t=b("umeng")||"{}";try{e=JSON.parse(t)}catch(t){e={}}return e}var O=0,U=2,D=1;"{}"!==JSON.stringify(N())&&(D=U);var j=function(){D=O;var t,e=decodeURIComponent(C("_toutiao_params")||C("_toutiao_recommend")||"");try{t=JSON.parse(e)}catch(t){return{}}return D=U,m("umeng",JSON.stringify(t)),t}(),J=D,T=new M("https://s3.pstatp.com/inapp/toutiao.js"),H=0,F=2,B=!o()&&/(UCBrowser|baiduboxapp|baidubrowser|MQQBrowser|QQ|MicroMessenger|Weibo|Opera|Firefox|MSIE|360SE|MetaSr|TheWorld|Firefox|LBBROWSER|Chrome|Safari)(\s|\/|_)(\S)/i.test(navigator.userAgent)?H:F;var V=function(){return t(this,void 0,void 0,function(){var e,n,o,r,i,a;return c(this,function(t){switch(t.label){case 0:return n=[{}],[4,T.adInfo];case 1:return n=n.concat([t.sent()]),[4,T.appInfo];case 2:return e=s.apply(void 0,n.concat([t.sent()])),o=100+10*T.adInfoFlag+T.appInfoFlag,r=1e3+100*T.adInfoFlag+10*J+B,i=s({},S(),N(),j,function(){var e,t=b("bridge")||"{}";try{e=JSON.parse(t)}catch(t){e={}}return e}(),e),a=JSON.parse(i.log_extra||"{}"),[2,{value:i.cid||"",log_extra:i.log_extra||"",req_id:i.req_id||a.req_id||"",cid:i.cid||"",ad_id:i.ad_id||C("_tt_ad_id")||C("ad_id")||"",device_id:i.device_id||"",user_id:i.user_id||"",uid:i.uid||"",ut:i.ut||"",app_version:i.appVersion||"",version_code:i.version_code||"",app_id:i.aid||"",os:u(),page_url:i.page_url,page_type:i.page_type,site_id:i.site_id,tt_bridge:o,tt_env:r}]}})})};$.prototype.handleLog=function(t,e){return{log:t,context:e}};function $(){}q.prototype.handleLog=function(t,e){try{var n=s({},e,t,{source:"webunion"});navigator.sendBeacon(this.API_URL,JSON.stringify(n))}catch(t){}};function q(t){this.API_URL=t}Q.prototype.handleLog=function(){};function Q(){}var W=(X.prototype.handleLog=function(t,e){var n="bytedance://"+(h.test(d)||w()||r()||i()?"log_event":"custom_event")+"?";this.isRealtimeReport(e.app_version)&&(n+="&realtime_report=1"),"ios"===u()?n+=this.formatData(s({},e,t)):n+=this.formatData(this.androidData(s({},e,t)));try{window.webkit.messageHandlers.observe.postMessage(n)}catch(t){console.log(n)}if(this.isVideoArticleCompatible(e.app_version))try{window.webkit.messageHandlers.consoleLog.postMessage(n)}catch(t){}},X.prototype.isVideoArticleCompatible=function(t){var e=!1;try{e=_.test(d)&&"ios"==u()&&parseInt(t.replace(/\./g,""))<=794&&779<=parseInt(t.replace(/\./g,""))}catch(t){}return e},X.prototype.formatData=function(t){var e="";for(var n in t)"object"==typeof t[n]?e+="&"+n+"="+encodeURIComponent(JSON.stringify(t[n])):e+="&"+n+"="+encodeURIComponent(t[n]);return e},X.prototype.androidData=function(t){return{category:t.category,tag:t.tag,label:t.label,value:t.cid,extra:t}},X.prototype.isRealtimeReport=function(t){return"6.6.7"===t},X);function X(){}Y.prototype.handleLog=function(t,e){var n=function(t,e){return{convert_id:t.convert_id||0,event_type:t.event_type||"",log_extra:e.log_extra,os:e.os,page_url:location.href,page_type:e.page_type}}(t,e),o=s({track_data:encodeURIComponent(JSON.stringify([n]))},e),r=this.API_URL+"?"+x(o);try{(new Image).src=window.location.protocol+r+"&t="+new Date}catch(t){}};function Y(t){this.API_URL=t}var G=(z.prototype.handleLog=function(t,e){var n="bytedance://log_event?",o=s({},e,t);for(var r in o)"object"==typeof o[r]?n+="&"+r+"="+encodeURIComponent(JSON.stringify(o[r])):n+="&"+r+"="+encodeURIComponent(o[r]);try{window.webkit.messageHandlers.observe.postMessage(n)}catch(t){console.log(n)}},z);function z(){}var K=(Z.prototype.handleLog=function(t,e){var n=function(t,e){return{convert_id:t.convert_id||0,event_type:t.event_type||"",log_extra:e.log_extra,os:e.os,page_url:location.href,page_type:e.page_type,xpath:t.xpath||"",select_content:t.select_content||"",event_value:t.event_value||""}}(t,e),o=s({track_data:encodeURIComponent(JSON.stringify([n]))},e),r=this.API_URL+"?"+x(o);try{!function t(e,n){var o=n||0,r=new XMLHttpRequest;r.open("GET",e.url,!1),r.withCredentials=!0,r.onreadystatechange=function(){4===r.readyState&&200!==r.status&&o<1&&t(e,++o)},r.send(null)}({url:window.location.protocol+r+"&t="+new Date})}catch(t){}},Z);function Z(t){this.API_URL=t}var tt={category:"umeng",tag:"embeded_ad",label:"convert"},et={sdk_version:"0.0.1"},nt=(ot.prototype.handleLog=function(t,e){if(t=s({},et,t),o()&&!this.isAwemeCompatible(e.app_version)&&!this.isLiveCompatible(e.app_version)||(t.select_content&&(t.select_content=encodeURIComponent(t.select_content)),this.httpHandler.handleLog(t,e)),o())return t=s({},tt,t),y.test(d)?this.iframeHandler.handleLog(t,e):this.consoleHandler.handleLog(t,e)},ot.prototype.isAwemeCompatible=function(t){var e=!1;try{e=i()&&"ios"==u()&&parseInt(t.replace(/\./g,""))<182}catch(t){}return e},ot.prototype.isLiveCompatible=function(t){var e=!1;try{e=r()&&"ios"==u()&&parseInt(t.replace(/\./g,""))<420}catch(t){}return e},ot);function ot(){this.httpHandler=new K("//isub.snssdk.com/2/wap/landing_tetris_log/"),this.iframeHandler=new G,this.consoleHandler=new W}var rt,it,at=["","webkit","Moz","MS","ms","o"],st=window,ct=void 0!==function(t,e){var n,o,r=e[0].toUpperCase()+e.slice(1),i=0;for(;i<at.length;){if((o=(n=at[i])?n+r:e)in t)return t[o];i++}return}(st,"PointerEvent"),ut="ontouchstart"in st;(it=rt=rt||{})[it.Default=0]="Default",it[it.Start=1]="Start",it[it.Move=2]="Move",it[it.End=4]="End",it[it.Cancle=8]="Cancle";var pt={pointer:{events:["pointerdown","pointermove","pointerup","pointercancel"],handler:function(t){var e=t.type,n={status:rt.Default,timestamp:Date.now(),position:[t.clientX,t.clientY]};return e!==this.events[0]||0!==t.button&&"touch"!==t.pointerType?e===this.events[1]?n.status=rt.Move:e===this.events[2]?n.status=rt.End:e===this.events[3]&&(n.status=rt.Cancle):n.status=rt.Start,n}},touch:{events:["touchstart","touchmove","touchend","touchcancel"],handler:function(t){var e=t.type;if(1!==t.changedTouches.length)return null;var n={status:rt.Default,timestamp:Date.now(),position:[t.changedTouches[0].clientX,t.changedTouches[0].clientY]};return e===this.events[0]?n.status=rt.Start:e===this.events[1]?n.status=rt.Move:e===this.events[2]?n.status=rt.End:e===this.events[3]&&(n.status=rt.Cancle),n.status===rt.Default?null:n}},mouse:{events:["mousedown","mousemove","mouseup"],handler:function(t){var e=t.type,n={status:rt.Default,timestamp:Date.now(),position:[t.clientX,t.clientY]};return e===this.events[0]&&0===t.button?n.status=rt.Start:e===this.events[1]?n.status=rt.Move:e===this.events[2]&&(n.status=rt.End),n.status&rt.Move&&1!==t.which&&(n.status=rt.End),n.status===rt.Default?null:n}}};"MSPointerEvent"in st&&!("PointerEvent"in st)&&(pt.pointer.events=["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel"]);var lt=250,dt=9;function ft(t,e,n){for(var o=0;o<t.length;o++)document.addEventListener(t[o],e,n)}var ht={addClickEvent:function(a,t){function e(n){var o,r,i;return function(t){var e=pt[n].handler(t);if(null!==e){if(e.status&rt.Start)return o=rt.Start,r=e.timestamp,void(i=e.position);if(e.status&rt.End)o&rt.Start&&e.timestamp-r<lt&&Math.sqrt(Math.pow(e.position[0]-i[0],2)+Math.pow(e.position[1]-i[1],2))<dt&&a(t);else if(e.status&rt.Move&&o&rt.Start)return}i=[r=o=0,0]}}ct?ft(pt.pointer.events,e("pointer"),t):ut?ft(pt.touch.events,e("touch"),t):ft(pt.mouse.events,e("mouse"),t)}};var vt,gt,_t,yt,wt=(function(t){function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}(t.exports=n).prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,o=this._callbacks["$"+t];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<o.length;r++)if((n=o[r])===e||n.fn===e){o.splice(r,1);break}return 0===o.length&&delete this._callbacks["$"+t],this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],o=1;o<arguments.length;o++)e[o-1]=arguments[o];if(n){o=0;for(var r=(n=n.slice(0)).length;o<r;++o)n[o].apply(this,e)}return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}}(vt={exports:{}},vt.exports),vt.exports),mt=new nt,bt=(n(gt=St,_t=yt=wt),void(gt.prototype=null===_t?Object.create(_t):(It.prototype=_t.prototype,new It)),St.prototype._init=function(t){for(;t.length;){var e=t.pop(),n=e[0],o=e.slice(1);this._invoke.apply(this,[n].concat(o))}},St.prototype.sendLog=function(n){return t(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,V()];case 1:return e=t.sent(),mt.handleLog(n,e),[2]}})})},St.prototype._get_basedata=function(){return t(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,V()];case 1:return[2,t.sent()]}})})},St.prototype.track=function(t,e){if("string"==typeof t){var n={event_type:t};e&&e.convert_id&&(n.convert_id=e.convert_id),this.sendLog(n),this.emit("track",n)}else console.log("event_type type error")},St);function It(){this.constructor=gt}function St(t){var r=yt.call(this)||this;return r._invoke=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];r[t]&&(e=r[t]).call.apply(e,[r].concat(n))},r._init(t),r}return function(){if(!window.meteor._invoke){window.meteor._invoke=!0;var t=(window.meteor||[]).slice(),e=new bt(t);window.meteor=e,function(){var r,t=document.getElementById("_tt_real_page_url")||null;function i(t){var e={};e.page_url=r||decodeURIComponent(location.href),e.event_type=t.getAttribute("tt-data-eventtype")||"",e.convert_id=t.getAttribute("tt-data-convertid")||"",e.event_value=t.getAttribute("tt-data-eventvalue")||"",e.target=t,e.options=t.getAttribute("tt-data-options")||"",window.meteor.track(s({},e,k(t)))}null!==t&&(r=t.getAttribute("href")||""),ht.addClickEvent(function(t){for(var e=t.target,n=e;e!=document;)"function"==typeof e.hasAttribute&&e.hasAttribute("tt-data-click")&&i(e),e=e.parentNode;if(e==document&&window._xpath_config){var o={};o.target=n,o.event_type="xpath",o.page_url=r||decodeURIComponent(location.href),window.meteor.track(s({},o,k(n)))}},!0),document.addEventListener("beforecopy",function(t){var e=document.getSelection().toString(),n=e.length,o=t.target;if(w()&&(e=encodeURIComponent(e)),window._xpath_config&&0<n&&n<200){var r={};r.target=o,r.select_content=e,r.event_type="xpath",window.meteor.track(s({},r,k(o)))}},!0)}()}}(),window.meteor}();
})();;(function(){if (typeof window._page_type == 'undefined') {
  var isTetris = ['ad.toutiao.com', 'www.toutiaopage.com', 'www.chengzijianzhan.com'].indexOf(location.hostname) > -1
  var isUnion = location.search.indexOf('_toutiao_params') > -1
  if (!isTetris && isUnion) {
    !function(){"use strict";!function(t,e){var r=t.insight=t.insight||[];if(r.start=+new Date,!r.initialize&&!r.invoked){r.invoked=!0,r.methods=["track","page","on","once", "config"],r.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),r.push(e),r}};for(var n=0;n<r.methods.length;n++){var a=r.methods[n];r[a]=r.factory(a)}r.load=function(){var t=e.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://s3.pstatp.com/bytecom/resource/analytics/alpha/v1.06/insight.js";var r=e.getElementsByTagName("script")[0];r.parentNode.insertBefore(t,r)},r.SNIPPET_VERSION="1.3.3",r.load()}}(window,document)}();
  }
}
})();